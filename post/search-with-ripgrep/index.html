<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Search with ripgrep | Chuck</title><meta name=keywords content="ripgrep"><meta name=description content="ripgrep is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep."><meta name=author content="Chuck"><link rel=canonical href=https://xuchengpeng.github.io/post/search-with-ripgrep/><link crossorigin=anonymous href=/assets/css/stylesheet.87a71c9fa3c46cbcceecb41d06747705e92409331a78d74e3ac78ce8b2f38eb1.css integrity="sha256-h6ccn6PEbLzO7LQdBnR3BekkCTMaeNdOOseM6LLzjrE=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xuchengpeng.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://xuchengpeng.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://xuchengpeng.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://xuchengpeng.github.io/apple-touch-icon.png><link rel=mask-icon href=https://xuchengpeng.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Search with ripgrep"><meta property="og:description" content="ripgrep is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep."><meta property="og:type" content="article"><meta property="og:url" content="https://xuchengpeng.github.io/post/search-with-ripgrep/"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-03-17T17:34:16+08:00"><meta property="article:modified_time" content="2018-03-17T17:34:16+08:00"><meta property="og:site_name" content="Chuck"><meta name=twitter:card content="summary"><meta name=twitter:title content="Search with ripgrep"><meta name=twitter:description content="ripgrep is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://xuchengpeng.github.io/post/"},{"@type":"ListItem","position":2,"name":"Search with ripgrep","item":"https://xuchengpeng.github.io/post/search-with-ripgrep/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Search with ripgrep","name":"Search with ripgrep","description":"ripgrep is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep.","keywords":["ripgrep"],"articleBody":"ripgrep is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep.\nIs it really faster than everything else? Generally, yes. A large number of benchmarks with detailed analysis for each is available on my blog.\nSummarizing, ripgrep is fast because:\nIt is built on top of Rust’s regex engine uses finite automata, SIMD and aggressive literal optimizations to make searching very fast. Rust’s regex library maintains performance with full Unicode support by building UTF-8 decoding directly into its deterministic finite automaton engine. It supports searching with either memory maps or by searching incrementally with an intermediate buffer. The former is better for single files and the latter is better for large directories. ripgrep chooses the best searching strategy for you automatically. Applies your ignore patterns in .gitignore files using a RegexSet. That means a single file path can be matched against multiple glob patterns simultaneously. It uses a lock-free parallel recursive directory iterator, courtesy of crossbeam and ignore. Benchmark This example searches the entire Linux kernel source tree (after running make defconfig \u0026\u0026 make -j8) for [A-Z]+_SUSPEND, where all matches must be words. Timings were collected on a system with an Intel i7-6900K 3.2 GHz, and ripgrep was compiled with SIMD enabled.\nTool Command Line count Time ripgrep (Unicode) rg -n -w '[A-Z]+_SUSPEND' 450 0.106s git grep LC_ALL=C git grep -E -n -w '[A-Z]+_SUSPEND' 450 0.553s The Silver Searcher ag -w '[A-Z]+_SUSPEND' 450 0.589s git grep (Unicode) LC_ALL=en_US.UTF-8 git grep -E -n -w '[A-Z]+_SUSPEND' 450 2.266s sift sift --git -n -w '[A-Z]+_SUSPEND' 450 3.505s ack ack -w '[A-Z]+_SUSPEND' 1878 6.823s The Platinum Searcher pt -w -e '[A-Z]+_SUSPEND' 450 14.208s Here’s another benchmark that disregards gitignore files and searches with a whitelist instead. The corpus is the same as in the previous benchmark, and the flags passed to each command ensure that they are doing equivalent work:\nTool Command Line count Time ripgrep rg -L -u -tc -n -w '[A-Z]+_SUSPEND' 404 0.079s ucg ucg --type=cc -w '[A-Z]+_SUSPEND' 390 0.163s GNU grep egrep -R -n --include='*.c' --include='*.h' -w '[A-Z]+_SUSPEND' 404 0.611s And finally, a straight-up comparison between ripgrep and GNU grep on a single large file (~9.3GB, OpenSubtitles2016.raw.en.gz):\nTool Command Line count Time ripgrep rg -w 'Sherlock [A-Z]\\w+' 5268 2.108s GNU grep LC_ALL=C egrep -w 'Sherlock [A-Z]\\w+' 5268 7.014s helm-ag with rg (use-package helm-ag :ensure t :after (helm) :config (setq helm-ag-base-command \"rg --color=always --smart-case --line-number --no-heading\") ) ","wordCount":"437","inLanguage":"en","datePublished":"2018-03-17T17:34:16+08:00","dateModified":"2018-03-17T17:34:16+08:00","author":{"@type":"Person","name":"Chuck"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xuchengpeng.github.io/post/search-with-ripgrep/"},"publisher":{"@type":"Organization","name":"Chuck","logo":{"@type":"ImageObject","url":"https://xuchengpeng.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xuchengpeng.github.io/ accesskey=h title="Chuck (Alt + H)"><img src=https://xuchengpeng.github.io/apple-touch-icon.png alt aria-label=logo height=35>Chuck</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://xuchengpeng.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://xuchengpeng.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://xuchengpeng.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://xuchengpeng.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://xuchengpeng.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://xuchengpeng.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://xuchengpeng.github.io/post/>Posts</a></div><h1 class=post-title>Search with ripgrep</h1><div class=post-description>ripgrep is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep.</div><div class=post-meta><span title='2018-03-17 17:34:16 +0800 +0800'>March 17, 2018</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;437 words&nbsp;·&nbsp;Chuck&nbsp;|&nbsp;<a href=https://github.com/xuchengpeng/xuchengpeng.github.io/tree/main/content/post/search-with-ripgrep.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#is-it-really-faster-than-everything-else>Is it really faster than everything else?</a></li><li><a href=#benchmark>Benchmark</a></li><li><a href=#helm-ag-with-rg>helm-ag with rg</a></li></ul></nav></div></details></div><div class=post-content><p><a href=https://github.com/BurntSushi/ripgrep>ripgrep</a> is a line-oriented search tool that recursively searches your current directory for a regex pattern while respecting your gitignore rules. ripgrep has first class support on Windows, macOS and Linux, with binary downloads available for every release. ripgrep is similar to other popular search tools like The Silver Searcher, ack and grep.</p><h2 id=is-it-really-faster-than-everything-else>Is it really faster than everything else?<a hidden class=anchor aria-hidden=true href=#is-it-really-faster-than-everything-else>#</a></h2><p>Generally, yes. A large number of benchmarks with detailed analysis for each is
<a href=http://blog.burntsushi.net/ripgrep/>available on my blog</a>.</p><p>Summarizing, ripgrep is fast because:</p><ul><li>It is built on top of
<a href=https://github.com/rust-lang-nursery/regex>Rust&rsquo;s regex engine</a> uses finite automata, SIMD and aggressive literal optimizations to make searching very fast.</li><li>Rust&rsquo;s regex library maintains performance with full Unicode support by building UTF-8 decoding directly into its deterministic finite automaton engine.</li><li>It supports searching with either memory maps or by searching incrementally with an intermediate buffer. The former is better for single files and the latter is better for large directories. ripgrep chooses the best searching strategy for you automatically.</li><li>Applies your ignore patterns in <code>.gitignore</code> files using a <a href=https://doc.rust-lang.org/regex/regex/struct.RegexSet.html><code>RegexSet</code></a>. That means a single file path can be matched against multiple glob patterns simultaneously.</li><li>It uses a lock-free parallel recursive directory iterator, courtesy of <a href=https://docs.rs/crossbeam><code>crossbeam</code></a> and <a href=https://docs.rs/ignore><code>ignore</code></a>.</li></ul><h2 id=benchmark>Benchmark<a hidden class=anchor aria-hidden=true href=#benchmark>#</a></h2><p>This example searches the entire Linux kernel source tree (after running make defconfig && make -j8) for [A-Z]+_SUSPEND, where all matches must be words. Timings were collected on a system with an Intel i7-6900K 3.2 GHz, and ripgrep was compiled with SIMD enabled.</p><table><thead><tr><th>Tool</th><th>Command</th><th>Line count</th><th>Time</th></tr></thead><tbody><tr><td><a href=https://github.com/BurntSushi/ripgrep>ripgrep</a> (Unicode)</td><td><code>rg -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td><strong>0.106s</strong></td></tr><tr><td><a href=https://www.kernel.org/pub/software/scm/git/docs/git-grep.html>git grep</a></td><td><code>LC_ALL=C git grep -E -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>0.553s</td></tr><tr><td><a href=https://github.com/ggreer/the_silver_searcher>The Silver Searcher</a></td><td><code>ag -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>0.589s</td></tr><tr><td><a href=https://www.kernel.org/pub/software/scm/git/docs/git-grep.html>git grep (Unicode)</a></td><td><code>LC_ALL=en_US.UTF-8 git grep -E -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>2.266s</td></tr><tr><td><a href=https://github.com/svent/sift>sift</a></td><td><code>sift --git -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>3.505s</td></tr><tr><td><a href=https://github.com/petdance/ack2>ack</a></td><td><code>ack -w '[A-Z]+_SUSPEND'</code></td><td>1878</td><td>6.823s</td></tr><tr><td><a href=https://github.com/monochromegane/the_platinum_searcher>The Platinum Searcher</a></td><td><code>pt -w -e '[A-Z]+_SUSPEND'</code></td><td>450</td><td>14.208s</td></tr></tbody></table><p>Here&rsquo;s another benchmark that disregards gitignore files and searches with a whitelist instead. The corpus is the same as in the previous benchmark, and the flags passed to each command ensure that they are doing equivalent work:</p><table><thead><tr><th>Tool</th><th>Command</th><th>Line count</th><th>Time</th></tr></thead><tbody><tr><td>ripgrep</td><td><code>rg -L -u -tc -n -w '[A-Z]+_SUSPEND'</code></td><td>404</td><td><strong>0.079s</strong></td></tr><tr><td><a href=https://github.com/gvansickle/ucg>ucg</a></td><td><code>ucg --type=cc -w '[A-Z]+_SUSPEND'</code></td><td>390</td><td>0.163s</td></tr><tr><td><a href=https://www.gnu.org/software/grep/>GNU grep</a></td><td><code>egrep -R -n --include='*.c' --include='*.h' -w '[A-Z]+_SUSPEND'</code></td><td>404</td><td>0.611s</td></tr></tbody></table><p>And finally, a straight-up comparison between ripgrep and GNU grep on a single large file (~9.3GB, <a href=http://opus.lingfil.uu.se/OpenSubtitles2016/mono/OpenSubtitles2016.raw.en.gz>OpenSubtitles2016.raw.en.gz</a>):</p><table><thead><tr><th>Tool</th><th>Command</th><th>Line count</th><th>Time</th></tr></thead><tbody><tr><td>ripgrep</td><td><code>rg -w 'Sherlock [A-Z]\w+'</code></td><td>5268</td><td><strong>2.108s</strong></td></tr><tr><td><a href=https://www.gnu.org/software/grep/>GNU grep</a></td><td><code>LC_ALL=C egrep -w 'Sherlock [A-Z]\w+'</code></td><td>5268</td><td>7.014s</td></tr></tbody></table><h2 id=helm-ag-with-rg>helm-ag with rg<a hidden class=anchor aria-hidden=true href=#helm-ag-with-rg>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-el data-lang=el><span class=line><span class=cl><span class=p>(</span><span class=nv>use-package</span> <span class=nv>helm-ag</span>
</span></span><span class=line><span class=cl>  <span class=nb>:ensure</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>  <span class=nb>:after</span> <span class=p>(</span><span class=nv>helm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>:config</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>setq</span> <span class=nv>helm-ag-base-command</span> <span class=s>&#34;rg --color=always --smart-case --line-number --no-heading&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://xuchengpeng.github.io/tags/ripgrep/>ripgrep</a></li></ul><nav class=paginav><a class=prev href=https://xuchengpeng.github.io/post/design-pattern-introduction/><span class=title>« Prev</span><br><span>设计模式简介</span></a>
<a class=next href=https://xuchengpeng.github.io/post/base16/><span class=title>Next »</span><br><span>base16 - An architecture for building themes</span></a></nav></footer><div class=article-comments><span id=/post/search-with-ripgrep/ class=leancloud-visitors data-flag-title="Search with ripgrep"><span class=post-meta-item-text>文章阅读量</span>
<span class=leancloud-visitors-count>0</span></span><div id=vcomments></div><script src=//unpkg.com/valine/dist/Valine.min.js></script>
<script type=text/javascript>new Valine({el:"#vcomments",appId:"8cGx0mI721mXnuSact0PLKmV-gzGzoHsz",appKey:"eQc0CtLv9s4VTdObz6ux8lVW",notify:"false",verify:"false",avatar:"wavatar",placeholder:"Leave your comments here...",visitor:"true"})</script></div></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><footer class=footer><span>&copy; 2023 <a href=https://xuchengpeng.github.io/>Chuck</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>